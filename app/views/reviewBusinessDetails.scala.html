@import models._
@import uk.gov.hmrc.play.frontend.auth.AuthContext
@(businessDetails: ReviewDetails,
  correspondenceAddress: Address,
  contactDetails: ContactDetails,
  contactDetailsEmail: Option[ContactDetailsEmail],
  emailAddress: Option[AgentEmail],
  clientDisplayName: Option[ClientDisplayName],
  backLink: Option[String])(implicit request: Request[_], authContext: AuthContext, messages: Messages)
@import uk.gov.hmrc.play.views.html._
@import uk.gov.hmrc.play.views.html.helpers._
@import views.html.helpers._
@import utils._
@import utils.AuthUtils._
@import controllers.auth.ExternalUrls

@atedMain(title = if(isAgent) { Messages("ated.review-details.agent.title") } else { Messages("ated.review-details.title") }) {
  @pageHeadersAndError(backLink, "subtitle", if(isAgent) {Messages("ated.review-details.agent.subheader")} else {Messages("ated.review-details.subheader")},
  "review-business-details-header", if(isAgent) {Messages("ated.review-details.agent.header")} else {Messages("ated.review-details.header")})

<div class="form-group">
  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="service-name-label" class="heading-small">@Messages("ated.review-details.service")</span>
    </div>

    <div class="grid grid-1-2 cya-answer">
      <span id="service-name">@Messages("ated.review-details.service.ated")</span>
    </div>
  </div>

  @if(businessDetails.isBusinessDetailsEditable){

  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="business-name-label" class="heading-small">@Messages("ated.review-details.business")</span>
    </div>

    <div class="grid grid-1-2 cya-answer">
      <span id="business-name">@businessDetails.businessName</span>
    </div>

    <div class="grid grid-1-6 cya-change">
      <a href='@ExternalUrls.businessNameAndAddressEditUrl' id="business-name-edit">@Messages("ated.review-details.edit")
        <span class="visuallyhidden">@Messages("ated.review-details.business")</span>
      </a>
    </div>

  </div>
  } else {
  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="business-name-label" class="heading-small">@Messages("ated.review-details.business")</span>
    </div>

    <div class="grid grid-1-2 cya-answer">
      <span id="business-name">@businessDetails.businessName</span>
    </div>

  </div>
  }
  @if(businessDetails.isBusinessDetailsEditable){
  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="business-address-label" class="heading-small">@Messages("ated.review-details.registered-address")</span>
    </div>

    <div class="grid grid-1-2 cya-answer">
      <div id="registered-address-line-1">@businessDetails.businessAddress.line_1</div>
      <div id="registered-address-line-2">@businessDetails.businessAddress.line_2</div>
      @businessDetails.businessAddress.line_3.map {line_3 =>
      <div id="registered-address-line-3">@line_3</div>
      }
      @businessDetails.businessAddress.line_4.map {line_4 =>
      <div id="registered-address-line-4">@line_4</div>
      }
      @businessDetails.businessAddress.postcode.map {postcode =>
      <div id="registered-postcode">@postcode</div>
      }
      <div id="registered-country">@AtedSubscriptionUtils.getSelectedCountry(businessDetails.businessAddress.country)</div>
    </div>

    <div class="grid grid-1-6 cya-change">
      <a href='@ExternalUrls.businessNameAndAddressEditUrl' id="register-address-edit">@Messages("ated.review-details.edit")
        <span class="visuallyhidden">@Messages("ated.review-details.registered-address")</span>
      </a>
    </div>
  </div>

  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="overseas-tax-reference-label" class="heading-small">@Messages("ated.review-details.overseas-tax-reference")</span>
    </div>

    <div class="grid grid-1-2 cya-answer">
    @businessDetails.identification.map { identification =>
      <div id="overseas-id-number">@identification.idNumber</div>
      <div id="overseas-issuingCountryCode">@AtedSubscriptionUtils.getSelectedCountry(identification.issuingCountryCode)</div>
      <div id="overseas-issuingInstitution">@identification.issuingInstitution</div>
    }
    </div>

    <div class="grid grid-1-6 cya-change">
      <a href='@ExternalUrls.overseasTaxReferenceEditUrl' id="overseas-tax-reference-edit">@Messages("ated.review-details.edit")
        <span class="visuallyhidden">@Messages("ated.review-details.overseas-tax-reference")</span>
      </a>
    </div>
  </div>

  }else {

  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="business-address-label" class="heading-small">@Messages("ated.review-details.registered-address")</span>
    </div>

    <div id="business-address" class="grid grid-1-2 cya-answer">

        <div id="registered-address-line-1">@businessDetails.businessAddress.line_1</div>
        <div id="registered-address-line-2">@businessDetails.businessAddress.line_2</div>
        @businessDetails.businessAddress.line_3.map {line_3 =>
        <div id="registered-address-line-3">@line_3</div>
        }
        @businessDetails.businessAddress.line_4.map {line_4 =>
        <div id="registered-address-line-4">@line_4</div>
        }
        @businessDetails.businessAddress.postcode.map {postcode =>
        <div id="registered-postcode">@postcode</div>
        }
        <div id="registered-country">@AtedSubscriptionUtils.getSelectedCountry(businessDetails.businessAddress.country)</div>
      </div>

  </div>

  }

  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="correspondence-address-label" class="heading-small">@Messages("ated.review-details.correspondence-address")</span>
    </div>

    <div id="business-address" class="grid grid-1-2 cya-answer">

      <div id="line_1">@correspondenceAddress.line_1</div>
      <div id="line_2">@correspondenceAddress.line_2</div>
      @correspondenceAddress.line_3.map {line_3 =>
      <div id="line_3">@line_3</div>
      }
      @correspondenceAddress.line_4.map { line_4 =>
      <div id="line_4">@line_4</div>
      }
      @correspondenceAddress.postcode.map {postcode =>
      <div id="postcode">@postcode</div>
      }
      <div id="country">@AtedSubscriptionUtils.getSelectedCountry(correspondenceAddress.country)</div>

    </div>

    <div class="grid grid-1-6 cya-change">
      <a href='@controllers.routes.CorrespondenceAddressController.editAddress(Some("edit"))' id="correspondence-edit" aria-label='@Messages("ated.review-details.edit-correspondence.title")' data-journey-click="ated-subscription:click:correspondence-edit">@Messages("ated.review-details.edit")
        <span class="visuallyhidden">@Messages("ated.review-details.correspondence-address")</span>
      </a>
    </div>

  </div>


  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="contact-details-label" class="heading-small">@Messages("ated.review-details.contact-details")</span>
    </div>

    <div id="business-address" class="grid grid-1-2 cya-answer">
      <div id="name">@contactDetails.firstName @contactDetails.lastName</div>
      <div id="telephone">@contactDetails.telephone</div>
    </div>

    <div class="grid grid-1-6 cya-change">
      <a href=@controllers.routes.ContactDetailsController.editDetails(Some("edit")) id="contact-edit" aria-label='@Messages("ated.review-details.edit-contact.title")' data-journey-click="ated-subscription:click:contact-edit">@Messages("ated.review-details.edit")
        <span class="visuallyhidden">@Messages("ated.review-details.contact-details")</span>
      </a>
    </div>

  </div>

  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="contact-pref-label" class="heading-small">@Messages("ated.review-details.contact-preference")</span>
    </div>

    <div id="contact-pref" class="grid grid-1-2 cya-answer">
      @if(contactDetailsEmail.isDefined && contactDetailsEmail.get.emailConsent) {
      @contactDetailsEmail.get.email
      }
    </div>

    <div class="grid grid-1-6 cya-change">
      <a href="@controllers.routes.ContactDetailsEmailController.editDetailsEmail" id="contact-pref-edit" aria-label='@Messages("ated.review-details.edit-contact-preference.title")' data-journey-click="ated-subscription:click:contact-pref-edit">@Messages("ated.review-details.edit")
        <span class="visuallyhidden">@Messages("ated.review-details.contact-preference")</span>
      </a>
    </div>
  </div>

  @if(clientDisplayName.isDefined) {
  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="client-display-name-label" class="heading-small">@Messages("ated.review-details.display-name")</span>
    </div>

    <div id="client-display-name" class="grid grid-1-2 cya-answer">
      @clientDisplayName.get.name
    </div>

    <div class="grid grid-1-6 cya-change">
      <a href='@ExternalUrls.clientDisplayNameEditPath' id="client-display-name-edit" aria-label='@Messages("ated.review-details.edit-display-name.title")' data-journey-click="ated-subscription:click:client-display-name-edit">@Messages("ated.review-details.edit")
      </a>
    </div>
  </div>
  }
  @if(emailAddress.isDefined) {
  <div class="grid-wrapper row-border">
    <div class="grid grid-2-6 cya-question">
      <span id="email-address-label" class="heading-small">@Messages("ated.review-details.email-address")</span>
    </div>

    <div id="email-address" class="grid grid-1-2 cya-answer">
      @emailAddress.get.email
    </div>

    <div class="grid grid-1-6 cya-change">
      <a href='@ExternalUrls.agentEmailEditPath' id="agent-email-address-edit" aria-label='@Messages("ated.review-details.edit-email-address.title")' data-journey-click="ated-subscription:click:agent-email-address-edit">@Messages("ated.review-details.edit")
      </a>
    </div>
  </div>

  }
</div>

  @form(action = controllers.routes.RegisterUserController.registerUser) {
  <button class="button" id="submit" type="submit" onclick="ga('send', 'event', 'Client - registration - end', 'button clicked')">
    @if(isAgent) {
    @Messages("ated.confirm-and-continue")
    } else {
    @Messages("ated.confirm-and-register")
    }
  </button>
  }

  }
